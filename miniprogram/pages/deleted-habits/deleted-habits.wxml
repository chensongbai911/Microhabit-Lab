<!-- å·²åˆ é™¤ä¹ æƒ¯é¡µé¢ -->
<view class="container">
  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{emptyState && !loading}}">
    <view class="empty-icon">ğŸ—‘ï¸</view>
    <view class="empty-text">æ²¡æœ‰å·²åˆ é™¤çš„ä¹ æƒ¯</view>
    <view class="empty-hint">æ‰€æœ‰ä¹ æƒ¯éƒ½å®‰å…¨å­˜åœ¨</view>
  </view>

  <!-- å·²åˆ é™¤ä¹ æƒ¯åˆ—è¡¨ -->
  <view class="habits-list" wx:else>
    <view class="list-header">
      <text>{{deletedHabits.length}} ä¸ªå·²åˆ é™¤ä¹ æƒ¯</text>
    </view>

    <view class="habit-card" wx:for="{{deletedHabits}}" wx:key="{{item._id}}">
      <!-- å¡ç‰‡å¤´ -->
      <view class="card-header">
        <view class="habit-title-section">
          <text class="habit-icon">ğŸ—‘ï¸</text>
          <text class="habit-name">{{item.name}}</text>
        </view>
        <view class="delete-time">{{item.deleted_date}}</view>
      </view>

      <!-- æ¢å¤å€’è®¡æ—¶ -->
      <view class="recovery-countdown">
        <view class="countdown-bar">
          <view class="countdown-fill" style="width: {{(item.remaining_days / 30) * 100}}%; background: linear-gradient(90deg, #4FC3F7 0%, rgba(79, 195, 247, 0.1) 100%);"></view>
        </view>
        <text class="countdown-text">
          {{item.can_restore ? 'å‰©ä½™ ' + item.remaining_days + ' å¤©å¯æ¢å¤' : 'æ¢å¤æœŸå·²è¿‡æœŸ'}}
        </text>
      </view>

      <!-- ä¹ æƒ¯ä¿¡æ¯ -->
      <view class="habit-info">
        <view class="info-row">
          <text class="info-label">è§¦å‘å™¨:</text>
          <text class="info-value">{{item.trigger}}</text>
        </view>
        <view class="info-row">
          <text class="info-label">ç›®æ ‡é¢‘ç‡:</text>
          <text class="info-value">æ¯å¤© {{item.target_times_per_day}} æ¬¡</text>
        </view>
        <view class="info-row">
          <text class="info-label">è¿›åº¦:</text>
          <text class="info-value">{{item.current_day || 0}}/{{item.total_days || 21}} å¤©</text>
        </view>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="actions">
        <button class="btn btn-restore"
                wx:if="{{item.can_restore}}"
                bindtap="restoreHabit"
                data-id="{{item._id}}"
                data-name="{{item.name}}">
          â†©ï¸ æ¢å¤
        </button>
        <button class="btn btn-restore"
                wx:else
                disabled="true">
          æ— æ³•æ¢å¤
        </button>
        <button class="btn btn-delete"
                bindtap="permanentDelete"
                data-id="{{item._id}}"
                data-name="{{item.name}}">
          âŒ æ°¸ä¹…åˆ é™¤
        </button>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <view class="spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>
</view>
