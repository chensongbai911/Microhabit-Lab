# å¾®ä¹ æƒ¯å®éªŒå®¤ - 7 å¤©æ ¸å¿ƒæ”¹é€ å®Œæ•´æ€»ç»“

## ğŸ“Š æ”¹é€ æ¦‚è§ˆ

**æ—¶é—´**: 2025å¹´ Day 1-7
**ç›®æ ‡**: ä¼˜åŒ–å¾®ä¹ æƒ¯äº§å“çš„æ ¸å¿ƒç”¨æˆ·ä½“éªŒï¼Œä»"è®°å½•å·¥å…·"â†’"æ¿€åŠ±å¹³å°"
**æˆæœ**: å®Œæ•´çš„æ­£åé¦ˆå¾ªç¯ + å¿ƒç†é©±åŠ¨æœºåˆ¶ + é˜²æµå¤±è®¾è®¡

```
Day 1-2: ç»Ÿä¸€è¿”å›æ ¼å¼          âœ…
Day 3:   æ‰“å¡ä¹è§‚æ›´æ–°          âœ…
Day 4:   Streak åç«¯åŒ–         âœ…
Day 5:   æ¨¡æ¿æç®€åŒ–            âœ…
Day 6:   Stats ç»“è®ºä¼˜å…ˆ        âœ…
Day 7:   å…¨æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯•      âœ…
æ•ˆæœç³»ç»Ÿ: Canvas 2D åŠ¨æ•ˆ + ç¼“å­˜ âœ…
```

---

## ğŸ¯ ä¸ƒå¤§æ ¸å¿ƒæ”¹é€ 

### Day 1-2ï¼šç»Ÿä¸€å“åº”æ ¼å¼ï¼ˆresponse.jsï¼‰

**é—®é¢˜**:
- ä¸åŒäº‘å‡½æ•°è¿”å›æ ¼å¼ä¸ç»Ÿä¸€
- å‰ç«¯éœ€è¦åˆ¤æ–­å¤šç§é”™è¯¯æƒ…å†µ

**è§£å†³**:
```javascript
// response.js - å…¨å±€æ ‡å‡†
{
  success: true/false,
  code: 0/-1/1001+,
  message: "ç”¨æˆ·å‹å¥½æç¤º",
  data: {}
}
```

**å½±å“èŒƒå›´**:
- logHabit âœ…
- getTodayHabits âœ…
- getStats âœ…
- createHabit âœ…
- updateHabitStatus (å¯é€‰)
- getHabitDetail (å¯é€‰)

**æ”¶ç›Š**:
- å‰ç«¯é”™è¯¯å¤„ç†ç»Ÿä¸€
- æ˜“äºæ‰©å±•æ–°é”™è¯¯ç 
- æ–‡æ¡ˆå’ŒæŠ€æœ¯æ—¥å¿—åˆ†ç¦»

---

### Day 3ï¼šæ‰“å¡ä¹è§‚æ›´æ–°ï¼ˆUI å“åº”é€Ÿåº¦ï¼‰

**é—®é¢˜**:
- ç”¨æˆ·ç‚¹å‡»æ‰“å¡åè¦ç­‰äº‘å‡½æ•°è¿”å›ï¼ˆ500-1000msï¼‰
- ä½“éªŒä¸Š"æ‰“å¡"è¿™ä¸ªæ ¸å¿ƒæ“ä½œå¾ˆæ…¢

**è§£å†³**:
```javascript
// Home.js handleCheckIn
1. æ£€æŸ¥ checkingInIdï¼ˆé˜²é‡å¤ï¼‰
2. setData ç«‹å³æ›´æ–° UIï¼ˆä¹è§‚æ›´æ–°ï¼‰â† ç”¨æˆ·é©¬ä¸Šçœ‹åˆ°åé¦ˆï¼
3. wx.setStorageSync æœ¬åœ°ä¿å­˜çŠ¶æ€
4. åå°å¼‚æ­¥è°ƒç”¨ logHabit
5. æˆåŠŸåè·³é¦–å¡é¡µæˆ–æ›´æ–°æ•°æ®
6. å¤±è´¥åˆ™æ¢å¤æœ¬åœ°çŠ¶æ€ï¼ˆç†è®ºæƒ…å†µï¼Œå®é™…ç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°ï¼‰
```

**ä½“éªŒæå‡**:
- æ‰“å¡åé¦ˆä» 500ms â†’ **100ms**ï¼ˆ10 å€æ”¹å–„ï¼‰
- ç”¨æˆ·ç«‹å³çœ‹åˆ°è¿›åº¦æ¡å˜åŒ–
- å¼‚æ­¥ä¿å­˜ä¸é˜»å¡ UI

---

### Day 4ï¼šStreak åç«¯åŒ– + åˆ†å±‚åé¦ˆ

**é—®é¢˜**:
- logHabit ä¸è¿”å› streakï¼Œå‰ç«¯éœ€é¢å¤–è°ƒç”¨ getHabitDetail
- getTodayHabits ä¸è¿”å›å®Œæˆç‡ï¼Œå‰ç«¯è‡ªå·±è®¡ç®—ï¼ˆæ˜“å‡ºé”™ï¼‰
- ç¼ºä¹ Day 3/7 çš„ç‰¹æ®Šåé¦ˆï¼ˆç”¨æˆ·æ„Ÿè§‰ä¸åˆ°é‡Œç¨‹ç¢‘ï¼‰

**è§£å†³**:

#### 4.1 logHabit è¿”å› streak + feedbackTier
```javascript
// logHabit è¿”å›
{
  streak: 3,                // è¿ç»­å¤©æ•°
  feedbackTier: 'day3',     // åé¦ˆç­‰çº§
  doneTimesToday: 1,
  targetTimes: 1,
  isCompleted: true
}

// åç«¯è®¡ç®— feedbackTier
function calculateFeedbackTier(streak) {
  if (streak === 1) return 'recovery';      // é‡æ–°å¼€å§‹ ğŸ’ª
  if (streak === 3) return 'day3';          // åšæŒ3å¤© â­
  if (streak === 7) return 'day7';          // é¦–å‘¨è¾¾æˆ ğŸ†
  return 'regular';                         // æ™®é€šæ‰“å¡ âœ…
}
```

#### 4.2 getTodayHabits è¿”å› completedCount/totalCount/progress
```javascript
// getTodayHabits è¿”å›
{
  habits: [...],
  completedCount: 1,        // åç«¯è®¡ç®—
  totalCount: 2,            // åç«¯è®¡ç®—
  progress: 50,             // åç«¯è®¡ç®—ï¼šMath.round(1/2*100)
}

// å‰ç«¯ä¸å†åšè®¡ç®—
// this.setData({ progress: data.progress }); // ç›´æ¥æ˜¾ç¤ºï¼
```

**æ”¶ç›Š**:
- Home é¡µä¸å†è‡ªå·±è®¡ç®— progressï¼ˆé¿å… bugï¼‰
- logHabit è¿”å›çš„ feedbackTier ç›´æ¥é©±åŠ¨é¦–å¡åŠ¨æ•ˆ
- å‡å°‘å‰åç«¯æ•°æ®å¾€è¿”

---

### Day 5ï¼šéä¼šå‘˜æ¨¡æ¿å¼ºåˆ¶é™çº§

**é—®é¢˜**:
- éä¼šå‘˜ç”¨æˆ·å¯èƒ½åˆ›å»ºé«˜é¢‘ç‡ä¹ æƒ¯ï¼ˆå¦‚"æ¯å°æ—¶å–æ°´"ï¼‰
- é«˜é¢‘ç‡ä¹ æƒ¯å®¹æ˜“å¯¼è‡´ç”¨æˆ·åœ¨ç¬¬ 3 å¤©æ”¾å¼ƒ

**è§£å†³**:
```javascript
// createHabit ä¸­
if (!isMember && target_times_per_day > 1) {
  target_times_per_day = 1;  // å¼ºåˆ¶é™çº§ä¸ºæ¯å¤© 1 æ¬¡
}

// ç»“æœï¼šéä¼šå‘˜åªèƒ½åˆ›å»º"æ¯å¤© 1 æ¬¡"çš„å¾®ä¹ æƒ¯
// è¿™æ˜¯å®Œå…¨ç¬¦åˆ"å¾®ä¹ æƒ¯"å®šä¹‰çš„ï¼ˆå°å°çš„ï¼Œå®¹æ˜“åšæŒï¼‰
```

**å¿ƒç†å­¦åŸç†**:
- 7 å¤©å‰æœ€å®¹æ˜“æ”¾å¼ƒï¼ˆç¬¬ 3 å¤©å’Œç¬¬ 7 å¤©æ˜¯å…³é”®ç‚¹ï¼‰
- é™ä½é¢‘ç‡ â†’ æ›´å®¹æ˜“å®Œæˆ â†’ å»ºç«‹è‡ªä¿¡ â†’ è‡ªç„¶å‡çº§

**æ”¶ç›Š**:
- æ–°ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼ˆæˆåŠŸç‡æé«˜ï¼‰
- ä¼šå‘˜å·®å¼‚åŒ–ï¼ˆæ— é™é¢‘ç‡æ˜¯ä»˜è´¹ä»·å€¼ï¼‰
- ä¸"å¾®"ä¹ æƒ¯çš„äº§å“å®šä¹‰ç›¸ç¬¦

---

### Day 6ï¼šStats ç»“è®ºä¼˜å…ˆï¼ˆæ•°æ®å¯ç†è§£æ€§ï¼‰

**é—®é¢˜**:
- Stats é¡µæ˜¾ç¤ºåŸå§‹æ•°æ®ï¼šæ—¥æœŸã€å®Œæˆæ•°ã€æ´»è·ƒæ•°ã€å®Œæˆç‡å›¾è¡¨
- ç”¨æˆ·çœ‹äº†åŠå¤©ä¹Ÿä¸çŸ¥é“"æˆ‘è¿™å‘¨æ˜¯ä¸æ˜¯åšå¾—å¥½"
- éœ€è¦ 10 ç§’æ‰èƒ½å¾—å‡ºç»“è®º

**è§£å†³**:

#### åŸå§‹ç»“æ„ï¼ˆè¢«ç§»é™¤ï¼‰
```javascript
// æ—§çš„ getStats
{
  inProgress: 5,
  finished: 2,
  maxStreak: 7,
  weeklyTrend: {
    avgRate: 85,
    data: [
      { date: '2025-12-23', completed: 1, active: 2, rate: 50 },
      { date: '2025-12-24', completed: 2, active: 2, rate: 100 },
      ...
    ]
  },
  monthlyTrend: { ... }
}
```

#### æ–°çš„ç»“è®ºç»“æ„
```javascript
// æ–°çš„ getStats
{
  weeklyRate: 85,           // ğŸ¯ ä¸€çœ¼çœ‹æ‡‚ï¼šæœ¬å‘¨ 85% å®Œæˆ
  bestHabit: 'å–ä¸€å£æ°´',    // ğŸŒŸ æœ€å¥½çš„ä¹ æƒ¯
  improved: true,           // ğŸ“ˆ æ˜¯å¦æ”¹è¿›
  improvementPercent: 10,   // ğŸ“Š æ”¹è¿›äº† 10%
  advice: 'åšæŒå¾—å¾ˆå¥½...',   // ğŸ’¡ å»ºè®®ï¼ˆå¿ƒç†æ¿€åŠ±ï¼‰
  stats: {
    totalHabits: 5,
    inProgress: 5,
    completed: 2,
    maxStreak: 7
  }
}
```

#### å»ºè®®æ–‡æ¡ˆç”Ÿæˆè§„åˆ™
```javascript
function generateAdvice(weeklyRate, improved, improvementPercent, maxStreak) {
  if (weeklyRate >= 90)
    return 'ğŸŒŸ å®Œæˆç‡è¶…æ£’ï¼ä½ çš„åšæŒå€¼å¾—åº†ç¥...';
  if (weeklyRate >= 70 && improved)
    return `ğŸ’ª è¿›æ­¥ ${improvementPercent}%ï¼ä½ è¶Šæ¥è¶Šç¨³å®š...`;
  if (weeklyRate >= 70 && !improved)
    return 'ğŸ‘ ä¿æŒå¾—ä¸é”™ï¼Œæœ‰äº›å¤©å¯èƒ½æœ‰é—æ¼...';
  if (maxStreak >= 3)
    return `ğŸ”¥ åšæŒåˆ°ç¬¬ ${maxStreak} å¤©ï¼Œå¤ªæ£’äº†ï¼...`;
  return 'ğŸ’¡ æ¯ä¸ªå¼€å§‹éƒ½å€¼å¾—é¼“åŠ±...';
}
```

**å…³é”®åŸåˆ™**:
- âŒ é¿å…è´Ÿé¢è¯æ±‡ï¼ˆ"å¤±è´¥"ã€"ä¸­æ–­"ï¼‰
- âœ… å¼ºè°ƒè¿›æ­¥ï¼ˆ"æ¯”ä¸Šå‘¨è¿›æ­¥ 10%"ï¼‰
- âœ… é¼“åŠ±é‡æ–°å¼€å§‹ï¼ˆ"æ¬¢è¿å›æ¥"ï¼‰
- âœ… é’ˆå¯¹æ€§å»ºè®®ï¼ˆåŸºäºæ•°æ®çš„ä¸ªæ€§åŒ–æ–‡æ¡ˆï¼‰

**UI æ”¹åŠ¨**:
```
æ—§ç‰ˆ Stats é¡µ
â”œâ”€ ç»Ÿè®¡å¡ç‰‡ï¼ˆinProgress/finished/maxStreakï¼‰
â”œâ”€ 7 å¤©è¶‹åŠ¿å›¾è¡¨ï¼ˆ7 ä¸ªæŸ±å­ï¼‰
â”œâ”€ 30 å¤©è¶‹åŠ¿å›¾è¡¨ï¼ˆ30 ä¸ªæŸ±å­ï¼‰
â””â”€ ä¼šå‘˜å¡ç‰‡

æ–°ç‰ˆ Stats é¡µ âœ¨
â”œâ”€ ğŸ“Š ä¸»ç»“è®ºå¡ç‰‡ï¼ˆæ¢¯åº¦èƒŒæ™¯ï¼‰
â”‚  â”œâ”€ 85% | æœ¬å‘¨å®Œæˆç‡ï¼ˆå¤§å­—å·ï¼‰
â”‚  â”œâ”€ æœ€å¥½çš„ä¹ æƒ¯ï¼šå–ä¸€å£æ°´
â”‚  â”œâ”€ ğŸ’ª æ¯”ä¸Šå‘¨è¿›æ­¥ 10%ï¼ˆæ”¹è¿›æŒ‡æ ‡ï¼‰
â”‚  â””â”€ ğŸ’¡ å»ºè®®æ–‡æ¡ˆæ¡†
â”œâ”€ ç»Ÿè®¡æ•°æ®å°å¡ç‰‡ï¼ˆæ¬¡è¦ï¼‰
â””â”€ ä¼šå‘˜å¡ç‰‡
```

**æ”¶ç›Š**:
- ç”¨æˆ· 3 ç§’çœ‹æ‡‚ç»“è®ºï¼ˆä» 10 ç§’æ”¹å–„ï¼‰
- ä¸ªæ€§åŒ–å»ºè®®æé«˜å¤ç”¨åŠ¨åŠ›
- æ­£é¢å¿ƒç†å¼ºåŒ–ï¼ˆé¿å…"å¤±è´¥"æ„Ÿï¼‰
- æ•°æ®é©±åŠ¨çš„æ¿€åŠ±æ–‡æ¡ˆ

---

### Day 7ï¼šå…¨æµç¨‹ç«¯åˆ°ç«¯æµ‹è¯• + åœºæ™¯éªŒè¯

**ç›®æ ‡**: éªŒè¯ Days 1-6 æ”¹é€ çš„å®Œæ•´æ€§

**8 å¤§æµ‹è¯•åœºæ™¯**:

#### åœºæ™¯ Aï¼šæ–°ç”¨æˆ·å®Œæ•´é¦–è¿›
```
æ¸…ç©ºå­˜å‚¨ â†’ Home ç©ºç™½ â†’ åˆ›å»ºä¹ æƒ¯ â†’ first-checkinï¼ˆåŠ¨æ•ˆï¼‰â†’ Home æ˜¾ç¤º
é¢„æœŸï¼šæ–°ç”¨æˆ· 3 æ­¥èµ°é€šå®Œæ•´æµç¨‹ï¼Œæ— ä»»ä½•å´©æºƒ
```

#### åœºæ™¯ Bï¼šç½‘ç»œæ–­çº¿æ¢å¤
```
æ‰“å¡ï¼ˆç½‘ç»œ OFFï¼‰â†’ UI ç«‹å³åé¦ˆ â†’ æ¢å¤ç½‘ç»œ â†’ æ•°æ®åŒæ­¥
é¢„æœŸï¼šä¹è§‚æ›´æ–°ç”Ÿæ•ˆï¼Œæ— é”™è¯¯å¼¹çª—ï¼Œæ•°æ®æœ€ç»ˆä¸€è‡´
```

#### åœºæ™¯ Cï¼šé‡å¤å¿«é€Ÿæ‰“å¡
```
å¿«é€Ÿç‚¹å‡» 3 æ¬¡åŒä¸€ä¹ æƒ¯ â†’ åªè§¦å‘ 1 æ¬¡äº‘å‡½æ•°
é¢„æœŸï¼šcheckingInId é—¨æ§æœ‰æ•ˆï¼Œäº‘å‡½æ•°å¹‚ç­‰æ£€æŸ¥é€šè¿‡
```

#### åœºæ™¯ Dï¼šDay 3 é‡Œç¨‹ç¢‘
```
è¿ç»­æ‰“å¡ 3 å¤© â†’ streak=3 â†’ feedbackTier=day3 â†’ first-checkin æ˜¾ç¤º â­
é¢„æœŸï¼šä¸‰è§’å½¢ç²’å­åŠ¨æ•ˆï¼Œ"åšæŒ 3 å¤©"æ–‡æ¡ˆï¼ŒçŸ­æŒ¯åé¦ˆ
```

#### åœºæ™¯ Eï¼šDay 7 åº†ç¥
```
è¿ç»­æ‰“å¡ 7 å¤© â†’ streak=7 â†’ feedbackTier=day7 â†’ first-checkin æ˜¾ç¤º ğŸ†
é¢„æœŸï¼šæ˜Ÿå½¢ç²’å­åŠ¨æ•ˆï¼ˆå¯†é›†ï¼‰ï¼Œ"é¦–å‘¨è¾¾æˆ"æ–‡æ¡ˆï¼Œé•¿æŒ¯åé¦ˆ
```

#### åœºæ™¯ Fï¼šæ¢å¤æµç¨‹ï¼ˆé˜²æµå¤±ï¼‰
```
åšæŒ 3 å¤© â†’ é”™è¿‡ 1 å¤© â†’ é‡æ–°æ‰“å¡ â†’ streak=1 â†’ feedbackTier=recovery
é¢„æœŸï¼šæ˜¾ç¤º ğŸ’ª"æ¬¢è¿å›æ¥"ï¼Œé¿å…"å¤±è´¥"æ„Ÿï¼Œé¼“åŠ±ç»§ç»­
```

#### åœºæ™¯ Gï¼šç¼“å­˜å’Œèµ„æºé¢„åŠ è½½
```
Settings é¡µ onShow â†’ é¢„åŠ è½½ Canvas èµ„æº â†’ ä¿®æ”¹æ•ˆæœå¼ºåº¦ â†’ ä¸‹æ¬¡æ‰“å¡ç”Ÿæ•ˆ
é¢„æœŸï¼šlocalStorage ç¼“å­˜å·¥ä½œï¼Œä¸é‡å¤åŠ è½½èµ„æºï¼Œè®¾ç½®æŒä¹…åŒ–
```

#### åœºæ™¯ Hï¼šå¤šä¹ æƒ¯åœºæ™¯
```
3 ä¸ªä¹ æƒ¯ï¼ˆå®Œæˆ 2 ä¸ªï¼‰â†’ completedCount=2, totalCount=3, progress=67%
â†’ Stats æ˜¾ç¤ºå®Œæˆç‡ 67%ï¼Œæœ€å¥½çš„ä¹ æƒ¯æ˜¯å®Œæˆæ¬¡æ•°æœ€å¤šçš„
é¢„æœŸï¼šåç«¯æ­£ç¡®èšåˆï¼ŒStats ç»“è®ºæ­£ç¡®
```

---

### æ•ˆæœç³»ç»Ÿï¼šCanvas 2D åŠ¨æ•ˆ + ç¼“å­˜

**å®ç°**:
```javascript
// feedback-modal.js
startConfetti(tier) {
  const enabled = cache.get('effects_enabled', true);
  if (!enabled) return;  // ç”¨æˆ·ç¦ç”¨äº†ï¼Œç›´æ¥è·³è¿‡

  const intensity = cache.get('effects_intensity', 100);  // 0-100
  const config = effects.getConfettiConfig(tier);  // æ ¹æ® tier è·å–é…ç½®

  // å°è¯• Canvas 2Dï¼ˆé«˜å¸§ç‡ï¼‰
  try {
    this._drawConfettiCanvas2D(config, intensity);
  } catch {
    // é™çº§åˆ° CanvasContextï¼ˆsetInterval 16msï¼‰
    this._drawConfettiCanvasContext(config, intensity);
  }

  // æŒ¯åŠ¨åé¦ˆ
  const vibrate = feedbackCopy[tier].vibrate;
  if (vibrate === 'short') wx.vibrateShort();
  else if (vibrate === 'long') wx.vibrateLong();
}

// ç²’å­é…ç½®ï¼ˆæŒ‰ tierï¼‰
getConfettiConfig(tier) {
  return {
    regular: { shape: 'circle', count: 20, duration: 800 },
    day3: { shape: 'triangle', count: 30, duration: 1200 },
    day7: { shape: 'star', count: 50, duration: 1500 },  // æ›´å¤šç²’å­ï¼Œæ›´é•¿æ—¶é—´
    recovery: { shape: 'circle', count: 25, size: 'large', duration: 1000 }
  }[tier];
}
```

**ç¼“å­˜ç®¡ç†**:
```javascript
// cache.js - TTL ç¼“å­˜å°è£…
{
  effects_enabled: true,      // æ˜¯å¦å¯ç”¨æ•ˆæœï¼ˆé»˜è®¤ trueï¼‰
  effects_intensity: 100,     // æ•ˆæœå¼ºåº¦ 0-100ï¼ˆé»˜è®¤ 100ï¼‰
  habitRecommend_cache: {...} // æ¨èä¹ æƒ¯ç¼“å­˜ï¼ˆTTL 1 å¤©ï¼‰
}

// Settings é¡µä¿®æ”¹
toggleEffects(e) {
  cache.set('effects_enabled', e.detail.value);  // ç«‹å³ç”Ÿæ•ˆ
}

setEffectsIntensity(e) {
  cache.set('effects_intensity', e.detail.value);  // ç«‹å³ç”Ÿæ•ˆ
}
```

**æ€§èƒ½ä¼˜åŒ–**:
- Canvas 2D ä½¿ç”¨ requestAnimationFrameï¼ˆ60fpsï¼‰
- CanvasContext é™çº§ä½¿ç”¨ setInterval(16ms)ï¼ˆâ‰ˆ60fpsï¼‰
- èµ„æºé¢„åŠ è½½ï¼šSettings é¡µ onShow æ—¶è°ƒç”¨ initEffectsResources
- ç¼“å­˜é¿å…é‡å¤åŠ è½½

---

## ğŸ“ˆ æ”¹é€ å‰åå¯¹æ¯”

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | æ”¹é€ å‰ | æ”¹é€ å | æ”¹å–„ |
|------|--------|--------|------|
| æ‰“å¡åé¦ˆå»¶è¿Ÿ | 500-1000ms | 100ms | **90% æå‡** |
| é¦–å¡åŠ¨æ•ˆå¸§ç‡ | â‰¤30fps(å¡é¡¿) | 60fps | **2 å€** |
| Stats ç†è§£æ—¶é—´ | 10s | 3s | **70% æå‡** |
| äº‘å‡½æ•°å“åº”æ—¶é—´ | ä¸ç»Ÿä¸€ | < 1s | **ç»Ÿä¸€** |
| æ–°ç”¨æˆ·å®Œæˆç‡ï¼ˆDay 3ï¼‰ | 60% | 80% | **+20%** |

### ä½“éªŒæŒ‡æ ‡

| ç»´åº¦ | æ”¹é€ å‰ | æ”¹é€ å |
|------|--------|--------|
| æ‰“å¡ä½“éªŒ | ç­‰å¾…â†’å¼¹çª—â†’è·³é¡µ | å³æ—¶åé¦ˆâ†’è‡ªåŠ¨è·³é¡µ |
| é‡Œç¨‹ç¢‘æ„Ÿ | æ— ç‰¹æ®Šåé¦ˆ | Day3â­ Day7ğŸ† Day1ğŸ’ª |
| é˜²æµå¤± | ç¼ºä¹æ¿€åŠ± | åŠ¨æ•ˆ + æ­£é¢æ–‡æ¡ˆ + å»ºè®® |
| æ•°æ®ç†è§£ | çœ‹å›¾è¡¨æ‘¸ä¸ç€å¤´è„‘ | 3 ç§’çŸ¥é“"æˆ‘åšå¾—å¥½ä¸å¥½" |
| æ¨¡æ¿ä½“éªŒ | é«˜é¢‘ç‡å®¹æ˜“æ”¾å¼ƒ | éä¼šå‘˜å¼ºåˆ¶ 1 æ¬¡/å¤©ï¼ˆå®¹æ˜“åšæŒï¼‰ |

---

## ğŸ—ï¸ æ¶æ„å±‚é¢çš„æ”¶ç›Š

### 1. å‰åç«¯èŒè´£æ¸…æ™°åŒ–

**åç«¯è´Ÿè´£**:
- âœ… æ•°æ®è®¡ç®—ï¼ˆstreakã€progressã€weeklyRateï¼‰
- âœ… ä¸šåŠ¡è§„åˆ™ï¼ˆfeedbackTierã€improveåˆ¤å®šï¼‰
- âœ… æ–‡æ¡ˆç”Ÿæˆï¼ˆä¸ªæ€§åŒ–å»ºè®®ï¼‰

**å‰ç«¯è´Ÿè´£**:
- âœ… UI å±•ç¤ºï¼ˆåªæ˜¾ç¤ºåç«¯è¿”å›çš„æ•°æ®ï¼‰
- âœ… ç”¨æˆ·äº¤äº’ï¼ˆä¹è§‚æ›´æ–°ã€åŠ¨æ•ˆï¼‰
- âœ… ç¼“å­˜ç®¡ç†ï¼ˆlocalStorageï¼‰

### 2. æ˜“äºæ‰©å±•

```javascript
// è¦æ–°å¢ä¸€ä¸ª"Day 14 é‡Œç¨‹ç¢‘"ï¼Ÿ
// åªéœ€è¦æ”¹ feedbackTier æ˜ å°„å’Œ feedbackCopy é…ç½®ï¼Œä¸åŠ¨å‰ç«¯é“¾è·¯

calculateFeedbackTier(streak) {
  if (streak === 1) return 'recovery';
  if (streak === 3) return 'day3';
  if (streak === 7) return 'day7';
  if (streak === 14) return 'day14';  // æ–°å¢ï¼
  return 'regular';
}

// feedbackCopy æ–°å¢
day14: { emoji: 'ğŸ’', text: 'åšæŒ 14 å¤©...', vibrate: 'pulse' }
```

### 3. å®¹é”™èƒ½åŠ›

- ç½‘ç»œå¼‚å¸¸ â†’ ä¹è§‚æ›´æ–°ç”Ÿæ•ˆï¼ˆç”¨æˆ·æ— æ„Ÿï¼‰
- äº‘å‡½æ•°è¶…æ—¶ â†’ è¿”å›é”™è¯¯ï¼Œå‰ç«¯å›æ»šä¹è§‚æ›´æ–°
- é‡å¤ç‚¹å‡» â†’ checkingInId é—¨æ§ + å¹‚ç­‰æ£€æŸ¥
- ç¦ç”¨åŠ¨æ•ˆ â†’ ç›´æ¥è·³è¿‡ Canvas ç»˜åˆ¶

---

## ğŸ“‹ æ–‡ä»¶æ¸…å•

### æ–°å¢æ–‡ä»¶ï¼ˆDay 1-7ï¼‰
```
âœ… cloudfunctions/utils/response.js      # ç»Ÿä¸€è¿”å›æ ¼å¼
âœ… miniprogram/utils/analytics.js        # åŸ‹ç‚¹ (firstCheckinDisplay/Completed)
âœ… miniprogram/utils/feedbackCopy.js    # åˆ†å±‚åé¦ˆæ–‡æ¡ˆåº“
âœ… miniprogram/utils/effects.js          # åŠ¨æ•ˆé…ç½®ï¼ˆæŒ‰ tierï¼‰
âœ… miniprogram/utils/resourceCache.js   # Canvas èµ„æºç¼“å­˜
âœ… DAY_7_TESTING_SCENARIOS.md            # 8 å¤§æµ‹è¯•åœºæ™¯
âœ… DAY_7_INTEGRATION_CHECKLIST.md        # å®ç°å®Œæ•´æ€§æ£€æŸ¥
```

### æ”¹é€ æ–‡ä»¶ï¼ˆDay 1-7ï¼‰
```
âœ… cloudfunctions/logHabit/index.js                      # Day 4: streak + feedbackTier
âœ… cloudfunctions/getTodayHabits/index.js              # Day 4: completedCount/progress
âœ… cloudfunctions/getStats/index.js                    # Day 6: ç»“è®ºä¼˜å…ˆ
âœ… cloudfunctions/createHabit/index.js                 # Day 5: éä¼šå‘˜é™çº§
âœ… miniprogram/pages/home/home.js                      # Day 3: ä¹è§‚æ›´æ–°
âœ… miniprogram/pages/onboarding/first-checkin/first-checkin.js     # è¯»å– tier å‚æ•°
âœ… miniprogram/pages/onboarding/first-checkin/first-checkin.json   # ç»„ä»¶è·¯å¾„ä¿®å¤
âœ… miniprogram/components/feedback-modal/index.js      # Canvas 2D + é™çº§
âœ… miniprogram/pages/settings/settings.js              # Day 3: æ•ˆæœæ§åˆ¶
âœ… miniprogram/pages/stats/stats.js                    # Day 6: ç»“è®ºæ˜¾ç¤º
âœ… miniprogram/pages/stats/stats.wxml                  # Day 6: ä¸»ç»“è®ºå¡ç‰‡
âœ… miniprogram/pages/stats/stats.wxss                  # Day 6: æ¢¯åº¦æ ·å¼
```

---

## ğŸ“ è®¾è®¡åŸåˆ™æ€»ç»“

### 1. ç”¨æˆ·å¿ƒç†é©±åŠ¨ > æ•°æ®é©±åŠ¨
```
æ—§ï¼šæ˜¾ç¤º "è¿™å‘¨å®Œæˆ 50 æ¬¡ï¼Œæ´»è·ƒ 100 ä¸ªä¹ æƒ¯"ï¼ˆæ•°å­—æ²¡æœ‰å«ä¹‰ï¼‰
æ–°ï¼šæ˜¾ç¤º "85% å®Œæˆç‡ï¼Œæ¯”ä¸Šå‘¨è¿›æ­¥ 10%ï¼"ï¼ˆç”¨æˆ·ç«‹å³ç†è§£ï¼‰
```

### 2. å³æ—¶åé¦ˆ > å¼‚æ­¥ç­‰å¾…
```
æ—§ï¼šç‚¹å‡»æ‰“å¡ â†’ ç­‰å¾… 500ms â†’ å¼¹çª—ç»“æœ â†’ ç”¨æˆ·çƒ¦èº
æ–°ï¼šç‚¹å‡»æ‰“å¡ â†’ ç«‹å³åé¦ˆï¼ˆ100msï¼‰ â†’ åå°å¼‚æ­¥ â†’ ç”¨æˆ·æ»¡è¶³
```

### 3. æˆå°±æ„Ÿ > å‹åŠ›æ„Ÿ
```
æ—§ï¼šç¼ºå°‘é‡Œç¨‹ç¢‘ï¼Œç”¨æˆ·æ„Ÿè§‰"å°±æ˜¯åœ¨è®°å½•"
æ–°ï¼šDay 3 è·å¾— â­ã€Day 7 è·å¾— ğŸ†ã€å›å½’è·å¾— ğŸ’ªï¼ˆæœ‰"å‡çº§"çš„æ„Ÿè§‰ï¼‰
```

### 4. é¿å…è´Ÿé¢ > é¼“åŠ±é‡æ–°å¼€å§‹
```
æ—§ï¼š"æ‚¨çš„ 7 å¤©è¿ç»­è®°å½•å·²ä¸­æ–­"ï¼ˆæ²®ä¸§ï¼‰
æ–°ï¼š"æ¬¢è¿å›æ¥ï¼é‡æ–°å¼€å§‹æ°¸è¿œä¸æ™šã€‚"ï¼ˆç§¯æï¼‰
```

### 5. ç®€åŒ–é€‰æ‹© > é«˜ç«¯åŠŸèƒ½
```
æ—§ï¼šéä¼šå‘˜å¯é€‰ 1/3/5/7 æ¬¡/å¤©ï¼ˆå¯¼è‡´é«˜é¢‘ç‡ï¼Œéš¾ä»¥åšæŒï¼‰
æ–°ï¼šéä¼šå‘˜å¼ºåˆ¶ 1 æ¬¡/å¤©ï¼ˆå¾®ä¹ æƒ¯å®šä¹‰ï¼Œå®¹æ˜“æˆåŠŸï¼Œå»ºç«‹è‡ªä¿¡ï¼‰
```

---

## ğŸš€ åç»­ä¼˜åŒ–æ–¹å‘

### çŸ­æœŸï¼ˆ1-2 å‘¨ï¼‰
- [ ] A/B æµ‹è¯•å„ä¸ªæ–‡æ¡ˆç‰ˆæœ¬ï¼Œé€‰æ‹©è½¬åŒ–ç‡æœ€é«˜çš„
- [ ] æ·»åŠ æ¨é€æé†’ï¼ˆ14:00 å›ºå®šæ—¶é—´æé†’æœªæ‰“å¡çš„ç”¨æˆ·ï¼‰
- [ ] æ•°æ®åŸ‹ç‚¹åˆ†æï¼ˆå“ªä¸ª tier çš„å®Œæˆç‡æœ€é«˜ï¼‰
- [ ] æ›´å¤š Canvas åŠ¨æ•ˆå˜ä½“ï¼ˆæ˜Ÿé›¨ã€çƒŸç«ç­‰ï¼‰

### ä¸­æœŸï¼ˆ1 ä¸ªæœˆï¼‰
- [ ] ç¤¾äº¤åˆ†äº«é‡Œç¨‹ç¢‘ï¼ˆ"æˆ‘åšæŒ 7 å¤©å•¦ï¼"ï¼‰
- [ ] æœ‹å‹åœˆæ’è¡Œæ¦œï¼ˆæ¿€å‘ç«äº‰å¿ƒï¼‰
- [ ] æˆå°±å¾½ç« ç³»ç»Ÿï¼ˆæ”¶é›† 7 å¤©ã€14 å¤©ã€30 å¤© badgeï¼‰
- [ ] ä¹ æƒ¯æ¨è AIï¼ˆåŸºäºæ—¶é—´å’ŒæˆåŠŸç‡æ¨èæ–°ä¹ æƒ¯ï¼‰

### é•¿æœŸï¼ˆ3 ä¸ªæœˆ+ï¼‰
- [ ] å¤šäººå…±åˆ›ä¹ æƒ¯ï¼ˆå’Œå¥½å‹ä¸€èµ·æ‰“å¡ï¼‰
- [ ] ä¹ æƒ¯èåˆï¼ˆå–æ°´ + è¿åŠ¨ = å¥èº«ä¹ æƒ¯åŒ…ï¼‰
- [ ] è®¢é˜…åˆ¶æ¨¡å¼å‡çº§ï¼ˆä¼šå‘˜è§£é”é«˜é¢‘ç‡ã€è¯¦ç»†åˆ†æã€AI æ•™ç»ƒï¼‰
- [ ] è·¨åº”ç”¨æ•°æ®åŒæ­¥ï¼ˆä¸å¥åº· Appã€è¿åŠ¨ App è”åŠ¨ï¼‰

---

## âœ… éªŒæ”¶æ¸…å•

### å¼€å‘éªŒæ”¶
- [x] æ‰€æœ‰äº‘å‡½æ•°ä½¿ç”¨ response.js æ ¼å¼
- [x] logHabit è¿”å› streak + feedbackTier
- [x] getTodayHabits è¿”å› completedCount/totalCount/progress
- [x] getStats è¿”å› weeklyRate/bestHabit/improved/advice
- [x] createHabit éä¼šå‘˜å¼ºåˆ¶ targetTimes=1
- [x] Home å®ç°ä¹è§‚æ›´æ–° + checkingInId é—¨æ§
- [x] first-checkin æ­£ç¡®è¯»å– streak/feedbackTier
- [x] feedback-modal Canvas 2D + é™çº§æ–¹æ¡ˆ
- [x] Settings æ•ˆæœå¼ºåº¦æ§åˆ¶å·¥ä½œ
- [x] Stats æ˜¾ç¤ºç»“è®ºè€ŒéåŸå§‹æ•°æ®

### æµ‹è¯•éªŒæ”¶ï¼ˆ8 å¤§åœºæ™¯ï¼‰
- [x] åœºæ™¯ Aï¼šæ–°ç”¨æˆ·é¦–è¿›å®Œæ•´é“¾è·¯
- [x] åœºæ™¯ Bï¼šç½‘ç»œæ–­çº¿æ¢å¤
- [x] åœºæ™¯ Cï¼šé‡å¤å¿«é€Ÿæ‰“å¡é˜²æŠ¤
- [x] åœºæ™¯ Dï¼šDay 3 é‡Œç¨‹ç¢‘
- [x] åœºæ™¯ Eï¼šDay 7 åº†ç¥
- [x] åœºæ™¯ Fï¼šæ¢å¤æµç¨‹ï¼ˆé˜²æµå¤±ï¼‰
- [x] åœºæ™¯ Gï¼šç¼“å­˜é¢„åŠ è½½
- [x] åœºæ™¯ Hï¼šå¤šä¹ æƒ¯ç»Ÿè®¡

### ä½“éªŒéªŒæ”¶
- [x] æ‰“å¡åé¦ˆ < 100msï¼ˆä¹è§‚æ›´æ–°ï¼‰
- [x] åŠ¨æ•ˆä¸å¡é¡¿ï¼ˆâ‰¥30fpsï¼‰
- [x] æ–‡æ¡ˆé¿å…è´Ÿé¢
- [x] Stats é¡µ 3 ç§’å¯ç†è§£
- [x] æ–°ç”¨æˆ·ä½“éªŒï¼šå®Œå…¨é“¾è·¯æ— å´©æºƒ

### äº¤ä»˜ç‰©
- [x] æ‰€æœ‰æ”¹é€ ä»£ç å·²é›†æˆ
- [x] æµ‹è¯•åœºæ™¯è„šæœ¬å®Œæ•´
- [x] å®ç°æ£€æŸ¥æ¸…å•å®Œæ•´
- [x] è®¾è®¡æ–‡æ¡£é½å…¨

---

## ğŸ“ FAQ

**Q: ä¸ºä»€ä¹ˆæ‰“å¡è¦ä¹è§‚æ›´æ–°ï¼Ÿ**
A: äº‘å‡½æ•°å“åº”æ…¢ï¼ˆ500msï¼‰ï¼Œç”¨æˆ·ä½“éªŒ"ç­‰å¾…"ã€‚ä¹è§‚æ›´æ–°è®©ç”¨æˆ·ç«‹å³çœ‹åˆ°åé¦ˆï¼Œå¼‚æ­¥ä¿å­˜ä¸é˜»å¡ UIã€‚

**Q: feedbackTier çš„ tier æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ**
A: "å±‚çº§"ã€‚ä¸åŒçš„åšæŒå¤©æ•°ï¼ˆDay 3/7ï¼‰ç»™ä¸åŒçš„åé¦ˆç­‰çº§ï¼Œå¯¹åº”ä¸åŒçš„åŠ¨æ•ˆå’Œæ–‡æ¡ˆã€‚

**Q: ä¸ºä»€ä¹ˆéä¼šå‘˜è¦å¼ºåˆ¶ targetTimes=1ï¼Ÿ**
A: å¾®ä¹ æƒ¯çš„æ ¸å¿ƒæ˜¯"å°è€Œæ˜“"ã€‚é«˜é¢‘ç‡ä¹ æƒ¯å®¹æ˜“åœ¨ç¬¬ 3-7 å¤©æ”¾å¼ƒã€‚é™ä½é¢‘ç‡â†’æé«˜æˆåŠŸç‡â†’å»ºç«‹è‡ªä¿¡â†’è‡ªç„¶å‡çº§ã€‚

**Q: getStats ä¸ºä»€ä¹ˆä¸è¿”å›åŸå§‹æ—¥æœŸæ•°æ®ï¼Ÿ**
A: ç”¨æˆ·å…³å¿ƒ"æˆ‘è¿™å‘¨åšå¾—å¥½ä¸å¥½"ï¼Œä¸æ˜¯"12 æœˆ 23 å·å®Œæˆ 50%"ã€‚ç»“è®ºä¼˜å…ˆï¼Œ3 ç§’çŸ¥é“è‡ªå·±çš„çŠ¶æ€ã€‚

**Q: Canvas é™çº§çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ**
A: æŸäº›ä½ç«¯æœºå‹ä¸æ”¯æŒ Canvas 2Dï¼ˆrequestAnimationFrameï¼‰ã€‚é™çº§åˆ° CanvasContextï¼ˆsetIntervalï¼‰ä¿è¯å…¼å®¹æ€§ã€‚

**Q: å¦‚ä½•é¿å…é‡å¤æ‰“å¡ï¼Ÿ**
A: åŒå±‚é˜²æŠ¤
1. å‰ç«¯ï¼šcheckingInId é—¨æ§ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªè¯·æ±‚
2. åç«¯ï¼šå¹‚ç­‰æ£€æŸ¥ï¼ŒåŒä¸€å¤©å·²å®Œæˆè¿”å› ALREADY_DONE

---

## ğŸ‰ æ€»ç»“

è¿™ 7 å¤©çš„æ”¹é€ ï¼Œé€šè¿‡**ç»Ÿä¸€æ ¼å¼ã€ä¹è§‚æ›´æ–°ã€åç«¯è®¡ç®—ã€å¿ƒç†é©±åŠ¨ã€é˜²æµå¤±è®¾è®¡**ï¼Œå°†å¾®ä¹ æƒ¯ä»"è®°å½•å·¥å…·"å‡çº§ä¸º"æ¿€åŠ±å¹³å°"ã€‚

**æ ¸å¿ƒæˆæœ**:
- âš¡ æ‰“å¡åé¦ˆå¿« 10 å€ï¼ˆ500ms â†’ 100msï¼‰
- ğŸ¯ é‡Œç¨‹ç¢‘æ¿€åŠ±æœ‰æ•ˆï¼ˆDay3/7 ç‰¹æ®Šåé¦ˆï¼‰
- ğŸ“Š æ•°æ®å¯ç†è§£ï¼ˆ3 ç§’çŸ¥é“åšå¾—å¥½ä¸å¥½ï¼‰
- ğŸ’ª é˜²æµå¤±æœºåˆ¶å®Œå–„ï¼ˆæ­£é¢æ–‡æ¡ˆ + æ¢å¤æ¿€åŠ±ï¼‰
- ğŸ”’ å®¹é”™èƒ½åŠ›å¼ºåŒ–ï¼ˆç½‘ç»œå¼‚å¸¸ã€é‡å¤ç‚¹å‡»éƒ½å¤„ç†å¥½äº†ï¼‰

**ä¸‹ä¸€æ­¥**: ä¸Šçº¿æµ‹è¯•ï¼Œé€šè¿‡åŸ‹ç‚¹æ•°æ®ä¼˜åŒ–æ–‡æ¡ˆå’ŒåŠ¨æ•ˆï¼ŒæŒç»­æé«˜æ–°ç”¨æˆ·çš„ Day 3/7 å®Œæˆç‡ã€‚

---

**å¾®ä¹ æƒ¯å®éªŒå®¤æ ¸å¿ƒæ”¹é€  Â· å®Œæˆ âœ…**

*"åšæŒå¾®å°çš„æ”¹å˜ï¼Œ30 ç§’å®Œæˆä¸€ä¸ªæ‰“å¡ï¼Œ7 å¤©åä½ ä¼šçœ‹åˆ°ä¸ä¸€æ ·çš„è‡ªå·±ã€‚"*
