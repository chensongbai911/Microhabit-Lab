# 微习惯 - 交互细节设计文档

**版本**：V2.0
**适用阶段**：Phase 1 开发
**最后更新**：2025-12-29

---

## 📱 关键交互细节

### 页面一：【今日】- 首屏最优化

#### 布局顺序（从上往下）
```
1. 时间 + 连续天数徽章（高对比）
   "今日 · 周三  | 第 3 天 🔥"

2. 进度卡片（视觉焦点）
   已完成 2/3 | ███████░░ 66%

3. 习惯列表（自动排序）
   - 未完成优先上移
   - 第一个未完成高亮黄色边框

4. 底部操作
   + 新建习惯  |  日期导航
```

#### 交互规则
| 操作 | 响应 | 说明 |
|------|------|------|
| 进入页面 | 自动滚到第一个未完成 | 减少用户寻找时间 |
| 点击未完成习惯 | 进入【打卡确认】模式 | 展示计时器（可选） |
| 完成打卡 | 进度条+1，列表项变灰 | 即时视觉反馈 |
| 所有完成 | 页面顶部显示"今日完成！" | 强化成就感 |

---

### 页面二：【打卡反馈弹层】- 成就激励核心

#### 反馈显示时长
- **显示**：打卡后立即出现（无延迟）
- **动画**：500-800ms（足够吸引，不过长）
- **退出**：手指点击或自动2秒后消失

#### 分级反馈细节

**Tier 1：日常打卡**
```
┌─────────────────┐
│  ✅              │  (按钮变灰)
│  已完成！        │
│                 │
│  已完成 2/3 ✓   │
└─────────────────┘

振动：轻（50ms单次）
声音：清脆"滴"（可选）
文案：轻松语气
```

**Tier 2：第3天打卡**
```
┌─────────────────┐
│     ⭐⭐⭐      │  (星星升空动画)
│ 坚持3天，太棒！  │
│ 很多人在这里放弃 │
│ 你超过他们了！   │
└─────────────────┘

振动：中等（50ms*2，间隔100ms）
声音：升调铃声
文案：鼓励+数据对标
```

**Tier 3：第7天打卡**
```
┌─────────────────┐
│    🏆 BOOM 💥   │  (烟花爆炸)
│  首周达成！      │
│  恭喜获得勋章    │
│  想再加一个目标？ │
│  [下一个] [稍后] │
└─────────────────┘

振动：强（50ms*4，梯度升高）
声音：胜利音乐（1.5秒）
文案：庆祝+行动唤起
```

**Tier 4：中断恢复后打卡**
```
┌─────────────────┐
│   💪 欢迎回来！   │
│ 没关系，重新开始  │
│ 也算数。加油！    │
│                 │
│  连续天数重置为 1 │
└─────────────────┘

振动：温和（25ms*2）
声音：温暖的"嗡"
文案：宽慰+重启希望
```

---

### 页面三：【防流失提示】- 关键时点干预

#### Day 2-3 未完成时

**位置**：页面底部浮窗（不挡住打卡按钮）

```
┌────────────────────────────┐
│ ⚠️  还有 3 小时就过期了！   │
│ [现在打卡] [稍后提醒]      │
└────────────────────────────┘
```

**特点**：
- 红色边框，吸引注意
- 支持向上滑动收起（不强制）
- 点击"现在打卡"直接进入打卡确认

**触发规则**：
```
if (当前时间 > 20:00 AND 当日未完成):
  显示浮窗，每5分钟刷新一次倒计时
```

#### Day 5 未完成时

**升级版提示**：使用轻弹窗
```
┌────────────────────────┐
│ 🎯 坚持5天就快到了！     │
│ 只需再完成1次…          │
│ [打卡] [今晚提醒]       │
└────────────────────────┘
```

**心理学理由**：
- 强调"就快到了"（进度心理学）
- 给出具体完成量："再1次"
- 允许延后（尊重自主权）

---

### 页面四：【习惯详情】- 快捷打卡点

#### 打开详情页时

```
╔════════════════════════════╗
║  拉伸1分钟               x  ║
║  连续 5 天 🔥 | 本周 5/7  ║
╠════════════════════════════╣
║  本周完成情况               ║
║  一  二  三  四  五  六  日  ║
║  ✔   ✔   ✔   ✘   ✔   ✔   ✘   ║
║                            ║
║  最长连续：7天（2周前）     ║
║  本月完成率：85%            ║
╠════════════════════════════╣
║  [今日打卡 - 完成]         ║
║  [编辑] [删除]              ║
╚════════════════════════════╝
```

**交互**：
- 在详情页也能快捷打卡（支持补卡场景）
- 连续天数用大号字体 + 火焰图标
- 日期可点击，展示单日详情

---

### 页面五：【新建习惯】- 分步简化

#### Step 1：难度选择

**样式**：单选卡片（Radio Button）

```
☑  超微级（≤30秒）
    示例：喝一杯水、做3个深呼吸、伸个懒腰

☐  微级（1-5分钟）
    示例：拉伸1分钟、读1页书

☐  轻级（5-15分钟）
    示例：跑步10分钟、做冥想
```

**默认选中**：超微级（推荐新手）

**交互**：点击卡片即选中，不需单独确认

#### Step 2：习惯名称

**输入框**：
```
我想要：[___________________]
```

**自动完成建议**（可选）：
- 根据选中难度级别推荐
- 支持搜索
- 不强制使用建议

#### Step 3：频率设置

**选项**（Radio Button）：
```
☑  每天一次（推荐新手）

☐  每周 [3] 次（自定义滑块）

☐  隔日一次
```

**提示文案**：
```
💡 建议新手从"每天一次"开始，
更容易形成习惯。后续可随时调整。
```

---

## 🕐 时间相关设计

### "过期时间"如何定义

```
Day N 的"有效打卡窗口"：
- 起点：Day N 00:00（日期切换）
- 终点：Day N 23:59:59

如果今日过期（超过23:59:59）：
- 打卡记录为 Day N-1 OR Day N？
  → 建议：根据【系统时间】判断，
    不按用户本地时间
```

### 周一重置逻辑

```
每周一 00:00:
- 清空"本周完成情况"
- 连续天数 → 「是否昨日完成」判断
  如果昨日完成：天数延续
  如果昨日未完成：重置为 1（如果今天完成）
```

---

## 🎨 色彩 & 动画规范

### 核心色系（建议）

```
主色（打卡）：    #FF6B6B（温暖红）
成功/完成色：    #51CF66（绿色）
未完成色：      #C1C7CD（浅灰）
强调色（勋章）：#FFD700（金色）

背景色：        #FFFFFF（白）或 #F8F9FA（浅灰白）
文字主色：      #1F2937（深灰）
文字次色：      #6B7280（中灰）
```

### 动画库（推荐使用）

| 效果 | 库 | 时长 |
|------|-----|------|
| 星星升空 | Lottie 或 CSS Animation | 600ms |
| 烟花爆炸 | canvas 或 Lottie | 1000ms |
| 进度条跳跃 | CSS transition | 300ms |
| 气泡浮出 | Keyframe | 500ms |

---

## 📊 性能约束

- **页面一加载时间**：< 500ms
- **打卡反馈延迟**：< 100ms（到反馈显示）
- **反馈动画帧率**：≥ 60fps
- **列表滚动**：不超过30个习惯（超过时分页）

---

## ✅ 测试用例（Critical）

| 场景 | 期望结果 |
|------|---------|
| 首次打开小程序 | 进入【今日】→【首卡激励】流程 |
| 首卡完成 | 显示Tier 3反馈（烟花） |
| Day 3 打卡 | 显示"坚持3天"相关文案 |
| Day 2 22:00未打卡 | 底部出现倒计时浮窗 |
| 中断1天后打卡 | 显示"欢迎回来"，连续天数重置 |
| 页面一全部完成 | 显示"今日完成！"，操作入口转为"浏览成就" |
| 统计页完成率计算 | 7天内完成数/7  ≠ 每日完成数求和/7 |

---

## 🔗 与其他系统集成

### 系统通知（可选二期）
```
Day 2 09:00：
"早上好！还没有开始今天的 [习惯名] ，
现在完成只需30秒 ⏱"

Day 5 20:00：
"坚持了4天，再来1次就能达成5天勋章！"

Day 7 21:00：
"今天就要完成首周达成了，一定可以！"
```

### 分享文案（可选二期）
```
我在微习惯已坚持 7 天 🔥
[喝一杯水：连续7天]
来和我一起养成好习惯吧！
```

---

**最后提醒**：这份文档是**设计指南**，具体样式和动画可根据UI风格调整，但**交互逻辑和时机必须保持**。
