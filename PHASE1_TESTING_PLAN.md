# Phase 1 测试计划 - 一步一步验证

**状态**: 代码已实现,开始测试验证

---

## 📋 测试环境准备

### 第1步: 准备工具
- [ ] 打开 WeChat 开发者工具
- [ ] 打开项目 `d:\AABBCC\miniprogram`
- [ ] 确认无编译错误(查看编译器面板)
- [ ] 打开手机模拟器(推荐 iPhone 12)
- [ ] 打开浏览器开发工具(F12)

### 第2步: 检查初始状态
- [ ] 小程序能正常加载
- [ ] 首页显示至少 1-2 个习惯
- [ ] 如果没有习惯,点击[+]创建一个新习惯
  - 名称: "晨跑"
  - 触发器: "每天早上7点"
  - 频次: 每天1次
  - 点击[创建]

---

## 🧪 测试场景1: 编辑功能 (Task 1.1 + 1.2)

**目标**: 验证编辑导航正确 + 显示进度信息

### 步骤1.1: 进入编辑页面

1. 首页找到任何一个习惯(比如"晨跑")
2. **长按该习惯卡片** → 显示菜单
3. 看到菜单中有 `[编辑]` 和 `[删除]` 选项
4. **点击 [编辑]**

**预期结果**:
```
✅ 页面导航到编辑页面
✅ 页面标题变为 "调整习惯"
✅ 显示习惯名称输入框(已填充)
✅ 显示触发器选项(已选中)
```

### 步骤1.2: 检查进度信息显示

进入编辑页面后,向下滚动查看,应该看到以下信息:

**检查点**:
```
┌─ 已进行 ─┐
│  X / 21天  │  ← 比如 "5/21天"
└──────────┘

┌─ 完成率 ─┐
│  X%       │  ← 比如 "23%"
└──────────┘

┌─ 最后完成 ─┐
│  今天/昨天  │  ← 或具体日期 "12-25"
│  或MM-DD   │
└────────────┘
```

**验证**:
- [ ] 看到 "已进行 X/21天" 信息
- [ ] 看到完成率百分比
- [ ] 看到最后完成时间
- [ ] 这些信息显示的数字合理(比如已进行5天,完成率23%)

### 步骤1.3: 修改习惯信息

在编辑页面上:

1. **修改习惯名称**
   - 清空原名称
   - 输入新名称,比如: "🏃 晨跑 加强版"
   - [ ] 名称成功输入

2. **修改触发器**
   - 点击触发器选择框
   - 选择新选项,比如: "每天早上7:30"
   - [ ] 触发器选择生效

3. **检查提交按钮**
   - 应该显示 "[保存]" 按钮
   - [ ] 按钮可以点击(非灰色)

### 步骤1.4: 保存修改

1. **点击 [保存] 按钮**
2. **观察加载状态**
   - [ ] 显示 "保存中..." 加载框
   - [ ] 约2秒后消失

3. **等待返回首页**
   - [ ] 显示 "保存成功" 提示(绿色)
   - [ ] 页面自动返回首页

### 步骤1.5: 验证数据更新

返回首页后检查:

1. **习惯名称是否更新**
   - [ ] 首页显示新名称 "🏃 晨跑 加强版"

2. **触发器是否更新**
   - [ ] 首页显示新触发器时间 "每天早上7:30"

3. **数据是否自动刷新**
   - [ ] **没有**手动下拉刷新,数据仍然自动更新
   - 这很关键！验证 Task 1.3 (数据刷新)

**期望结果** (✅ 全部通过):
```
✅ 编辑页面正确显示
✅ 进度信息显示完整
✅ 修改后保存成功
✅ 返回首页自动刷新
✅ 习惯信息已更新
```

---

## 🧪 测试场景2: 删除功能 (Task 1.4)

**目标**: 验证删除确认详细 + 操作安全

### 步骤2.1: 触发删除操作

1. 首页找到任何一个习惯
2. **长按该习惯卡片** → 显示菜单
3. **点击 [删除]**

**预期结果**:
```
弹框标题:
"确定要删除吗?"

弹框内容(示例):
"删除"晨跑"
已进行5/21天

数据将保存在「已完成」分区,无法恢复"

按钮:
[确认删除] (红色)  [取消] (灰色)
```

### 步骤2.2: 验证提示信息

检查弹框内容,确认包含以下信息:

- [ ] 显示习惯名称: "删除"XXX""
- [ ] 显示已进行天数: "已进行 X/21天"
- [ ] 显示数据去向: "数据将保存在「已完成」分区"
- [ ] 显示无法恢复: "无法恢复"
- [ ] 确认按钮是**红色**(表示危险操作)

### 步骤2.3: 取消删除

1. **点击 [取消]**

**预期结果**:
- [ ] 弹框关闭
- [ ] 返回首页
- [ ] 习惯仍然存在
- [ ] 菜单关闭

### 步骤2.4: 再次删除(确认删除)

1. 再次找到要删除的习惯
2. 长按 → 点击 [删除]
3. 这次**点击 [确认删除]**

**预期结果**:
```
显示 "删除中..." 加载框
↓ (约1-2秒)
加载框消失
↓
显示 "删除成功" 提示(绿色)
↓
首页列表自动更新,该习惯消失
```

### 步骤2.5: 验证列表更新

- [ ] 首页列表自动更新(无需手动刷新)
- [ ] 删除的习惯不再显示
- [ ] 其他习惯仍然存在

**期望结果** (✅ 全部通过):
```
✅ 删除确认显示详细信息
✅ 弹框包含习惯名称
✅ 弹框显示已进行天数
✅ 弹框显示数据保留说明
✅ 取消删除有效
✅ 确认删除成功
✅ 首页列表自动更新
```

---

## 🧪 测试场景3: 边界情况

**目标**: 测试特殊情况和错误处理

### 场景3.1: 新建习惯(不编辑)

1. 首页点击 [+] 按钮
2. **不**选择现有习惯,正常创建新习惯
3. 填写表单,点击 [创建]

**验证**:
- [ ] 新建模式下不显示进度信息
- [ ] 只显示标题 "新建微习惯" 和子标题
- [ ] 创建成功返回首页

### 场景3.2: 编辑未完成的习惯

找一个刚创建的习惯(completed_days = 0):

1. 进入编辑模式
2. 检查进度信息

**验证**:
- [ ] 完成率显示为 0%
- [ ] 最后完成时间显示 "未完成"

### 场景3.3: 编辑已完成的习惯

找一个已完成的习惯(status = 'completed'):

1. 进入编辑模式
2. 检查进度信息

**验证**:
- [ ] 完成率显示为 100%
- [ ] 显示完成日期

### 场景3.4: 网络错误处理

在编辑页面修改后:

1. **关闭网络**(开发者工具 > Network Throttling > Offline)
2. 点击 [保存]
3. 观察反应

**验证**:
- [ ] 显示错误提示: "保存失败,请检查网络"
- [ ] 页面不返回(留在编辑页)
- [ ] 用户可以再次尝试

---

## 📊 测试结果汇总表

完成上述所有测试后,填写以下表格:

| 测试项 | 预期结果 | 实际结果 | 通过? | 备注 |
|--------|---------|---------|-------|------|
| **1.1** 编辑导航正确 | 进入create-habit页 | ✅ 或 ❌ | ✅/❌ |  |
| **1.2** 显示进度信息 | 显示已X/21天+完成率+时间 | ✅ 或 ❌ | ✅/❌ |  |
| **1.3** 数据自动刷新 | 无需手动刷新,自动更新 | ✅ 或 ❌ | ✅/❌ |  |
| **1.4a** 删除确认详细 | 显示名称+天数+保留说明 | ✅ 或 ❌ | ✅/❌ |  |
| **1.4b** 删除操作安全 | 二次确认+按钮红色 | ✅ 或 ❌ | ✅/❌ |  |
| **1.4c** 删除列表更新 | 列表自动更新 | ✅ 或 ❌ | ✅/❌ |  |
| **3.1** 新建模式 | 不显示进度,只显示标题 | ✅ 或 ❌ | ✅/❌ |  |
| **3.2** 0完成率 | 显示0%和"未完成" | ✅ 或 ❌ | ✅/❌ |  |
| **3.3** 100完成率 | 显示100%和完成日期 | ✅ 或 ❌ | ✅/❌ |  |
| **3.4** 网络错误 | 显示错误提示,不返回 | ✅ 或 ❌ | ✅/❌ |  |

---

## 🐛 如果发现问题

如果某个测试失败,请记录:

1. **问题描述**: 具体发生了什么
2. **重现步骤**: 如何一步步重现
3. **错误信息**: 控制台/弹框显示的错误
4. **预期行为**: 应该发生什么
5. **实际行为**: 实际发生了什么

**示例**:
```
问题: 删除后首页列表不更新
重现:
  1. 首页显示2个习惯
  2. 长按第一个习惯,点删除,确认
  3. 返回首页,列表仍显示2个习惯
错误: 无明显错误,但列表未刷新
解决: 需要手动下拉刷新才能看到更新
```

---

## ✅ 全部通过标准

当以下条件都满足时,Phase 1 测试 **✅ 通过**:

- ✅ 所有10个测试项都通过
- ✅ 没有发现未预期的行为
- ✅ 没有控制台错误信息
- ✅ 所有操作都有正确反馈
- ✅ 用户体验符合预期

---

## 🚀 下一步行动

| 场景 | 行动 |
|------|------|
| ✅ 全部通过 | 启动 Phase 2 (触发器优化) |
| ⚠️ 部分失败 | 分析问题,修复代码,重新测试 |
| ❌ 多个失败 | 检查环境配置,重新部署 |

---

**开始测试**！🎯

第1步: 准备工具和初始状态 (5分钟)
第2步: 测试编辑功能 (10分钟)
第3步: 测试删除功能 (5分钟)
第4步: 测试边界情况 (10分钟)

**总计**: 约30分钟
